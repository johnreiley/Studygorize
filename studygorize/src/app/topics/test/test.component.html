<div class="content-wrapper-600 m-auto">
  <div class="test-content" *ngIf="!showResults; else results">
    <div class="row">
      <div class="col-10">
        <h2>{{ topic?.title }} Test</h2>
      </div>
      <div class="col-2">
        <span class="counter">{{ currentQuestionIndex + 1 }}/{{ test?.questions.length }}</span>
      </div>
    </div>
    <form>
      <div id="{{'question-' + (currentQuestionIndex + 1)}}" class="form-group">
        <label for="{{'questionInput-' + (currentQuestionIndex + 1)}}">  
          <strong class="mr-1">{{ currentQuestionIndex + 1 }}.</strong><span>{{ test?.questions[currentQuestionIndex].name }}</span>
        </label>
        <input 
          name="answerInput"
          class="form-control" 
          type="text" 
          id="{{'questionInput-' + (currentQuestionIndex + 1)}}" 
          [(ngModel)]="test?.questions[currentQuestionIndex].userResponse">
      </div>
      <div class="row">
        <div class="col-12 mb-3">
          <button
            type="button"
            *ngIf="testConfig?.allowPrevousNavigation && currentQuestionIndex > 0"
            #previous
            class="btn btn-outline-dark icon-btn-left float-left"
            (click)=onPrevious(previous)>
            <i class="material-icons">arrow_back</i>
            Previous
          </button>
          <button
            *ngIf="!isLast"
            #next
            class="btn btn-outline-dark icon-btn-right float-right"
            (click)=onNext(next)>
            Next
            <i class="material-icons">arrow_forward</i>
          </button>
          <button 
            *ngIf="isLast"
            #submit
            class="btn btn-success icon-btn-right float-right"
            (click)="onNext(submit)">
            Submit
            <i class="material-icons">done_outline</i>
          </button>
        </div>
      </div>
    </form>
  </div>

  <ng-template #results>
    <h2>{{ topic?.title }} Test</h2>
    <h4>Grade: {{ test.grade }}%</h4>
    <h4>Correct: {{ test.totalCorrect }}/{{ test.questions.length }}</h4>
    <div *ngFor="let question of test?.questions; let i = index;" id="{{'question-' + i}}" class="form-group">
      <label for="{{'questionInput-' + i}}">  
        <strong class="mr-1">{{ i + 1 }}.</strong><span>{{ question.name }}</span>
      </label>
      <div class="input-group mb-2">
        <div class="input-group-prepend">
          <button *ngIf="question.isCorrect(); else incorrect" class="input-group-text text-success icon-btn" aria-label="correct" disabled>
            <i class="material-icons">done</i>
          </button>
          <ng-template #incorrect>
            <button class="input-group-text text-danger icon-btn" aria-label="incorrect" disabled>    
              <i class="material-icons">close</i>
            </button>
          </ng-template>
        </div>
        <input class="form-control" type="text" id="{{'questionInput-' + i}}" [value]="question.userResponse" readonly disabled>
      </div>
      <div class="form-group">
        <label for="{{'answer-' + i}}">Answer:</label>
        <div class="card" id="{{'answer-' + i}}">
          <div class="card-body p-3">
            {{ question.answer }}
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</div>
